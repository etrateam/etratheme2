{# ========== SAFE MASTER (ZERO CONFLICTS) ========== #}
{# لا نضيف أي <salla-...> هنا إلا الضروري جدًا، ونضمن app.js مرة واحدة فقط #}

<!DOCTYPE html>
<html lang="{{ user.language.code }}" dir="{{ user.language.dir }}">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  {{ theme.settings.set('placeholder', 'images/placeholder.png') }}

  {# أي أصول تخص شاشة التحميل إن وُجدت #}
  {% include 'pages.partials.loading-screen-assets' %}

  {# سكربتات خفيفة لو حابين قبل CSS #}
  {% block head_scripts %}{% endblock %}

  {% hook 'head:start' %}
  {% hook head %}

  {# الستايلات — تأكدي من استخدام theme.font.url وليس path #}
  {% block styles %}{% endblock %}
  <link rel="stylesheet" href="{{ 'app.css' | asset }}">
  {% if theme.font and theme.font.url %}
    <link rel="stylesheet" href="{{ theme.font.url }}"/>
  {% endif %}
  <link rel="stylesheet" href="{{ 'fonts/sallaicons.css'|cdn }}"/>

  <style>
    :root {
      --font-main: '{{ theme.font ? theme.font.name : "inherit" }}';
      --color-primary: {{ theme.color.primary }};
      --color-primary-dark: {{ theme.color.darker(0.15) }};
      --color-primary-light: {{ theme.color.lighter(0.15) }};
      --color-primary-reverse: {{ theme.color.reverse_text }};
    }
  </style>

  {% hook 'head:end' %}
</head>

<body id="app" class="overflow-x-hidden {% hook 'body:classes' %}
  {{ theme.settings.get('footer_is_dark') ? ' footer-is-dark' : ' footer-is-light' }}
  {{ theme.settings.get('topnav_is_dark') ? ' topnav-is-dark' : '' }}
  {{ theme.settings.get('sticky_add_to_cart') ? ' is-sticky-product-bar' : '' }}
">
  <div class="loader-init"></div>

  <noscript>
    To get full functionality of this site you need to enable JavaScript.
    <a href="https://www.enable-javascript.com/" target="_blank" rel="noreferrer">How to enable JavaScript</a>.
  </noscript>

  <div class="app-inner flex flex-col min-h-full">
    {% hook 'body:start' %}

    {# الهيدر الافتراضي #}
    {% component 'header.header' %}

    {# محتوى الصفحات #}
    {% block content %}{% endblock %}

    {# الفوتر الافتراضي #}
    {% component 'footer.footer' %}
  </div>

  {% hook 'body:end' %}

  {# أهم شيء: app.js مرة واحدة فقط #}
  <script defer src="{{ 'app.js' | asset }}"></script>

  {# لا نضيف هنا الآن: <salla-search> ولا <salla-login-modal> ولا <salla-offer-modal>  #}
  {# سنرجعها لاحقًا بعد ما نتأكد أن الصفحة صارت تعمل بدون شاشة بيضاء #}
  <salla-search></salla-search>


  {% block scripts %}{% endblock %}
</body>
</html>
